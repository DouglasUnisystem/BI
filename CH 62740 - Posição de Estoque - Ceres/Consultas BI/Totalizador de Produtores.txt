SELECT NOME_CLIENTE,  
       ROUND(SUM(SALDO_KG),2) AS SALDO_KG,
       ROUND(SUM(SALDO_SC),2) AS SALDO_SC
  FROM (
SELECT CL.SEQ_PLA_CLIENTE,
       CL.NOME_CLIENTE,
       CE.SEQ_PLA_ENDERECO,
       CE.DESC_ENDERECO,
       CE.ENDERECO,
       DECODE(ET.PESO_BRUTO    ,NULL,0,ET.PESO_BRUTO/     1) AS PESO_BRUTO_KG,
       DECODE(ET.DESCONTOS     ,NULL,0,ET.DESCONTOS/      1) AS DESCONTOS_KG,
       DECODE(ET.DES_SERVICO   ,NULL,0,ET.DES_SERVICO/    1) +
       DECODE(TS.TAXA_SERVICO  ,NULL,0,TS.TAXA_SERVICO/   1) AS DES_SERVICO_KG,
       DECODE(ET.PESO_LIQUIDO  ,NULL,0,ET.PESO_LIQUIDO/   1) AS PESO_LIQUIDO_KG,
       DECODE(SA.SAIDAS        ,NULL,0,SA.SAIDAS/         1) AS SAIDAS_KG,
       DECODE(T1.TRANSFERENCIA ,NULL,0,T1.TRANSFERENCIA/  1) AS TRANSF_MAIS_KG,
       DECODE(T2.TRANSFERENCIA ,NULL,0,T2.TRANSFERENCIA/  1) AS TRANSF_MENOS_KG,
       DECODE(QT.QUEBRA_TECNICA,NULL,0,QT.QUEBRA_TECNICA/ 1) AS QUEBRA_TECNICA_KG,
       DECODE(ET.PESO_LIQUIDO  ,NULL,0,(ET.PESO_LIQUIDO/  1) )+
       DECODE(T1.TRANSFERENCIA ,NULL,0,(T1.TRANSFERENCIA/ 1) )-
       DECODE(T2.TRANSFERENCIA ,NULL,0,(T2.TRANSFERENCIA/ 1) )-
       DECODE(QT.QUEBRA_TECNICA,NULL,0,(QT.QUEBRA_TECNICA/1) )-
       DECODE(TS.TAXA_SERVICO  ,NULL,0,(TS.TAXA_SERVICO/  1) )-
       DECODE(SA.SAIDAS        ,NULL,0,(SA.SAIDAS/        1) ) AS SALDO_KG,
       
       DECODE(ET.PESO_BRUTO    ,NULL,0,ET.PESO_BRUTO/     60) AS PESO_BRUTO_SC,
       DECODE(ET.DESCONTOS     ,NULL,0,ET.DESCONTOS/      60) AS DESCONTOS_SC,
       DECODE(ET.DES_SERVICO   ,NULL,0,ET.DES_SERVICO/    60) +
       DECODE(TS.TAXA_SERVICO  ,NULL,0,TS.TAXA_SERVICO/   60) AS DES_SERVICO_SC,
       DECODE(ET.PESO_LIQUIDO  ,NULL,0,ET.PESO_LIQUIDO/   60) AS PESO_LIQUIDO_SC,
       DECODE(SA.SAIDAS        ,NULL,0,SA.SAIDAS/         60) AS SAIDAS_SC,
       DECODE(T1.TRANSFERENCIA ,NULL,0,T1.TRANSFERENCIA/  60) AS TRANSF_MAISV,
       DECODE(T2.TRANSFERENCIA ,NULL,0,T2.TRANSFERENCIA/  60) AS TRANSF_MENOS_SC,
       DECODE(QT.QUEBRA_TECNICA,NULL,0,QT.QUEBRA_TECNICA/ 60) AS QUEBRA_TECNICA_SC,
       DECODE(ET.PESO_LIQUIDO  ,NULL,0,(ET.PESO_LIQUIDO/  60) )+
       DECODE(T1.TRANSFERENCIA ,NULL,0,(T1.TRANSFERENCIA/ 60) )-
       DECODE(T2.TRANSFERENCIA ,NULL,0,(T2.TRANSFERENCIA/ 60) )-
       DECODE(QT.QUEBRA_TECNICA,NULL,0,(QT.QUEBRA_TECNICA/60) )-
       DECODE(TS.TAXA_SERVICO  ,NULL,0,(TS.TAXA_SERVICO/  60) )-
       DECODE(SA.SAIDAS        ,NULL,0,(SA.SAIDAS/        60) ) AS SALDO_SC
  FROM CERES2311.CLIENTES_ENDERECOS CE,
       CERES2311.CLIENTES           CL,
       (SELECT ET.SEQ_PLA_ENDERECO,
               SUM(PESO_BRUTO) AS PESO_BRUTO,
               SUM(DESCONTOS) AS DESCONTOS,
               SUM(DES_SERVICO) AS DES_SERVICO,
               SUM(PESO_LIQUIDO) AS PESO_LIQUIDO
               ,ET.COD_EMPRESA, ET.COD_FILIAL, ET.COD_SAFRA--, ET.SEQ_PLA_ARMAZEM, ET.SEQ_PLA_PRODUTO
          FROM VW_ENTRADAS      ET
         WHERE 1 = 1
           &EMPRESA
           &FILIAL
           &SAFRA
           &ARMAZEM
           &PRODUTO
         GROUP BY ET.SEQ_PLA_ENDERECO,ET.COD_EMPRESA, ET.COD_FILIAL, ET.COD_SAFRA--, ET.SEQ_PLA_ARMAZEM, ET.SEQ_PLA_PRODUTO
       ) ET,

       (SELECT SA.SEQ_PLA_ENDERECO,
               SUM(SAIDAS) AS SAIDAS
               ,SA.COD_EMPRESA, SA.COD_FILIAL, SA.COD_SAFRA--, SA.SEQ_PLA_ARMAZEM, SA.SEQ_PLA_PRODUTO
          FROM VW_SAIDAS SA
         WHERE 1 = 1
           &EMPRESA
           &FILIAL
           &SAFRA
           &ARMAZEM
           &PRODUTO
           &DATA_INI
           &DATA_FIM
         GROUP BY SA.SEQ_PLA_ENDERECO, SA.COD_EMPRESA, SA.COD_FILIAL, SA.COD_SAFRA--, SA.SEQ_PLA_ARMAZEM, SA.SEQ_PLA_PRODUTO
       ) SA,

       (SELECT TR.SEQ_PLA_ENDERECO,
               SUM(TRANSFERENCIA) AS TRANSFERENCIA
               ,TR.COD_EMPRESA, TR.COD_FILIAL, TR.COD_SAFRA--, TR.SEQ_PLA_ARMAZEM, TR.SEQ_PLA_PRODUTO
          FROM VW_TRANSF_ENTRADAS  TR
         WHERE 1 = 1
           &EMPRESA
           &FILIAL
           &SAFRA
           &ARMAZEM
           &PRODUTO
           &DATA_INI
           &DATA_FIM
         GROUP BY TR.SEQ_PLA_ENDERECO, TR.COD_EMPRESA, TR.COD_FILIAL, TR.COD_SAFRA--, TR.SEQ_PLA_ARMAZEM, TR.SEQ_PLA_PRODUTO
       ) T1,

       (SELECT TR.SEQ_PLA_ENDERECO,
               SUM(TRANSFERENCIA) AS TRANSFERENCIA
               , TR.COD_EMPRESA, TR.COD_FILIAL, TR.COD_SAFRA--, TR.SEQ_PLA_ARMAZEM, TR.SEQ_PLA_PRODUTO
          FROM VW_TRANSF_SAIDAS TR
         WHERE 1 = 1
           &EMPRESA
           &FILIAL
           &SAFRA
           &ARMAZEM
           &PRODUTO
           &DATA_INI
           &DATA_FIM              
         GROUP BY TR.SEQ_PLA_ENDERECO, TR.COD_EMPRESA, TR.COD_FILIAL, TR.COD_SAFRA--, TR.SEQ_PLA_ARMAZEM, TR.SEQ_PLA_PRODUTO
       ) T2,

       (SELECT QT.SEQ_PLA_ENDERECO,
               SUM(QUEBRA_TECNICA) AS QUEBRA_TECNICA
               , QT.COD_EMPRESA, QT.COD_FILIAL, QT.COD_SAFRA--, QT.SEQ_PLA_ARMAZEM, QT.SEQ_PLA_PRODUTO
          FROM VW_QUEBRA_TECNICA QT
         WHERE 1 = 1
           &EMPRESA
           &FILIAL
           &SAFRA
           &ARMAZEM
           &PRODUTO
           &DATA_INI
           &DATA_FIM          
         GROUP BY QT.SEQ_PLA_ENDERECO, QT.COD_EMPRESA, QT.COD_FILIAL, QT.COD_SAFRA--, QT.SEQ_PLA_ARMAZEM, QT.SEQ_PLA_PRODUTO
       ) QT,

       (SELECT TS.SEQ_PLA_ENDERECO,
               SUM(TAXA_SERVICO) AS TAXA_SERVICO
               , TS.COD_EMPRESA, TS.COD_FILIAL, TS.COD_SAFRA--, TS.SEQ_PLA_ARMAZEM, TS.SEQ_PLA_PRODUTO
          FROM VW_TAXA_SERVICO TS
         WHERE 1 = 1
           &EMPRESA
           &FILIAL
           &SAFRA
           &ARMAZEM
           &PRODUTO
           &DATA_INI
           &DATA_FIM           
         GROUP BY TS.SEQ_PLA_ENDERECO, TS.COD_EMPRESA, TS.COD_FILIAL, TS.COD_SAFRA--, TS.SEQ_PLA_ARMAZEM, TS.SEQ_PLA_PRODUTO
       ) TS

 WHERE 1 = 1
   AND CE.SEQ_PLA_CLIENTE  = CL.SEQ_PLA_CLIENTE
   AND CE.SEQ_PLA_ENDERECO = ET.SEQ_PLA_ENDERECO(+)
   AND CE.SEQ_PLA_ENDERECO = SA.SEQ_PLA_ENDERECO(+)
   AND CE.SEQ_PLA_ENDERECO = T1.SEQ_PLA_ENDERECO(+)
   AND CE.SEQ_PLA_ENDERECO = T2.SEQ_PLA_ENDERECO(+)
   AND CE.SEQ_PLA_ENDERECO = QT.SEQ_PLA_ENDERECO(+)
   AND CE.SEQ_PLA_ENDERECO = TS.SEQ_PLA_ENDERECO(+)
)
WHERE 1 = 1
  AND (SALDO_KG <> 0 OR SALDO_SC <> 0)
GROUP BY NOME_CLIENTE
ORDER BY NOME_CLIENTE ASC