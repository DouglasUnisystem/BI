--NOTAS DE COMPRA (dfmCtrCompra)
SELECT SIGLA_FILIAL,
       DATA_ENTRADA,
       COD_TIPO_LCTO,
       DESC_TIPO_LCTO,
       '' AS NR_ROMANEIO,
       NR_DOCUMENTO,
       QUANTIDADE,
       QTD_NF,
       QTDE_TOTAL,
       UNITARIO,
       VALOR_TOTAL,
       VALOR_FUNRURAL,
       VALOR_SENAR,
       VALOR_RAT,
       VALOR_FETHAB,
       VALOR_IMAFIR,
       VALOR_IAGRO,
       VALOR_FACS,
       VALOR_ICMS,
       VALOR_LIQUIDO,
       NR_DOCUMENTO_DEVOLUCAO
  FROM VW_DETALHE_CTR_COMPRA_ROM EE
 WHERE 1 = 1
   AND EE.ID = :ID
 UNION
SELECT SIGLA_FILIAL,
       DATA_ENTRADA,
       COD_TIPO_LCTO,
       DESC_TIPO_LCTO,
       '' AS NR_ROMANEIO,
       NR_DOCUMENTO,
       QUANTIDADE,
       QTD_NF,
       QTDE_TOTAL,
       UNITARIO,
       VALOR_TOTAL,
       VALOR_FUNRURAL,
       VALOR_SENAR,
       VALOR_RAT,
       VALOR_FETHAB,
       VALOR_IMAFIR,
       VALOR_IAGRO,
       VALOR_FACS,
       VALOR_ICMS,
       VALOR_LIQUIDO,
       NR_DOCUMENTO_DEVOLUCAO
  FROM VW_DETALHE_CTR_COMPRA_ENT EE
 WHERE 1 = 1
   AND (EE.SEQ_PLA_ORIGEM  = :ID OR EE.ID  IN (SELECT CD.SEQ_PLA_CONT_DES FROM CERES2311.COMPRA_DESMEMBRAMENTO CD WHERE CD.SEQ_PLA_CTR_COMPRA = :ID))
UNION
SELECT SIGLA_FILIAL,
       DATA_ENTRADA,
       COD_TIPO_LCTO,
       DESC_TIPO_LCTO,
       '' AS NR_ROMANEIO,
       NR_DOCUMENTO,
       QUANTIDADE,
       QTD_NF,
       QTDE_TOTAL,
       UNITARIO,
       VALOR_TOTAL,
       VALOR_FUNRURAL,
       VALOR_SENAR,
       VALOR_RAT,
       VALOR_FETHAB,
       VALOR_IMAFIR,
       VALOR_IAGRO,
       VALOR_FACS,
       VALOR_ICMS,
       VALOR_LIQUIDO,
       NR_DOCUMENTO_DEVOLUCAO
  FROM VW_DETALHE_CTR_COMPRA_DEV EE
 WHERE 1 = 1
   AND EE.ID = :ID  
--NOTAS DE VENDA (dfmCtrSaida3)  
UNION
SELECT DISTINCT * FROM (
SELECT SIGLA_FILIAL,
       DATA_EMISSAO,
       COD_TIPO_LCTO,
       '' AS DESC_TIPO_LCTO,
       NR_ROMANEIO,
       NR_DOCUMENTO,
       QUANTIDADE,
       QTD_NOTA AS QTD_NF,
       QTDE_TOTAL,
       UNITARIO,
       VALOR_TOTAL,
       VALOR_FUNRURAL,
       VALOR_SENAR,
       VALOR_RAT,
       VALOR_FETHAB,
       VALOR_IMAFIR,
       VALOR_IAGRO,
       VALOR_FACS,
       VALOR_ICMS,
       VALOR_LIQUIDO,
       NR_DOCUMENTO_DEVOLUCAO
  FROM VW_DETALHE_CTR_VENDA_SAI
 WHERE 1 = 1
   AND ID = :ID
UNION
SELECT SIGLA_FILIAL,
       DATA_EMISSAO,
       COD_TIPO_LCTO,
       '' AS DESC_TIPO_LCTO,
       NR_ROMANEIO,
       NR_DOCUMENTO,
       QUANTIDADE,
       QTD_NOTA AS QTD_NF,
       QTDE_TOTAL,
       UNITARIO,
       VALOR_TOTAL,
       VALOR_FUNRURAL,
       VALOR_SENAR,
       VALOR_RAT,
       VALOR_FETHAB,
       VALOR_IMAFIR,
       VALOR_IAGRO,
       VALOR_FACS,
       VALOR_ICMS,
       VALOR_LIQUIDO,
       NR_DOCUMENTO_DEVOLUCAO
  FROM VW_DETALHE_CTR_VENDA_DEV
 WHERE 1 = 1
   AND (SEQ_PLA_ORIGEM = :ID OR ID  IN (SELECT CDD.SEQ_PLA_CONT_DES FROM CERES2311.CONTRATO_DESMEMBRAMENTO CDD WHERE CDD.SEQ_PLA_PED_VENDA = :ID))
UNION
SELECT SIGLA_FILIAL,
       DATA_EMISSAO,
       COD_TIPO_LCTO,
       '' AS DESC_TIPO_LCTO,
       NR_ROMANEIO,
       NR_DOCUMENTO,
       QUANTIDADE,
       QTD_NOTA AS QTD_NF,
       QTDE_TOTAL,
       UNITARIO,
       VALOR_TOTAL,
       VALOR_FUNRURAL,
       VALOR_SENAR,
       VALOR_RAT,
       VALOR_FETHAB,
       VALOR_IMAFIR,
       VALOR_IAGRO,
       VALOR_FACS,
       VALOR_ICMS,
       VALOR_LIQUIDO,
       NR_DOCUMENTO_DEVOLUCAO
  FROM VW_DETALHE_CTR_VENDA_ROM
 WHERE 1 = 1
   AND ID = :ID
)