CREATE MATERIALIZED VIEW VW_TAXA_SERVICO REFRESH FORCE ON DEMAND START WITH SYSDATE NEXT SYSDATE + 5/24/60 AS
SELECT TS.SEQ_PLA_CLIENTE AS SEQ_PLA_ENDERECO,
       SUM(NVL(TS.QUANTIDADE,0)) AS TAXA_SERVICO,
       TS.COD_EMPRESA,
       TS.COD_FILIAL,
       TS.COD_SAFRA,
       TS.SEQ_PLA_ARMAZEM,
       TS.SEQ_PLA_PRODUTO,
       TS.DATA
  FROM AGRICOLA.TAXA_SERVICO   TS,
       AGRICOLA.PRODUTOS       PD,
       AGRICOLA.SUB_GRUPO      SG
 WHERE 1 = 1
   AND TS.SEQ_PLA_PRODUTO   = PD.SEQ_PLA_PRODUTO  (+)
   AND PD.SEQ_PLA_SUB_GRUPO = SG.SEQ_PLA_SUB_GRUPO(+)
    GROUP BY TS.SEQ_PLA_CLIENTE, TS.COD_EMPRESA, TS.COD_FILIAL, TS.COD_SAFRA, TS.SEQ_PLA_ARMAZEM, TS.SEQ_PLA_PRODUTO, TS.DATA;
