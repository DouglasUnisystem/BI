CREATE MATERIALIZED VIEW VW_CONTRATO_COMPRA REFRESH FORCE ON DEMAND START WITH SYSDATE NEXT SYSDATE + 5/24/60 AS
SELECT CC.SEQ_PLA_CTR_COMPRA AS ID,
       CL.NOME_CLIENTE AS PRODUTOR_COMPRADOR,
       CE.ENDERECO     AS ENDERECO_COMPRADOR,
       CC.DATA_CONTRATO AS DATA,
       CC.NR_CONTRATO,
       CC.LETRA_CONTRATO,
       CC.QUANTIDADE,
       CC.PRECO_SACA AS UNITARIO,
       CC.VALOR_TOTAL,
       PD.DESCRICAO_PRODUTO,
       SF.DESCRICAO_SAFRA,
       EP.NOME_EMPRESA,
       FI.DESCRICAO_FILIAL,
       UN.SIGLA_UNIDADE,
       CC.COD_EMPRESA,
       CC.COD_FILIAL,
       CC.COD_SAFRA,
       CC.SEQ_PLA_PRODUTO
  FROM AGRICOLA.COMPRA_CONTRATO    CC,
       AGRICOLA.CLIENTES_ENDERECOS CE,
       AGRICOLA.CLIENTES           CL,
       AGRICOLA.PRODUTOS           PD,
       AGRICOLA.UNIDADE_PRODUTO    UN,
       AGRICOLA.MOEDAS             MO,
       AGRICOLA.EMPRESAS           EP,
       AGRICOLA.SAFRAS             SF,
       AGRICOLA.FILIAIS            FI
 WHERE CC.SEQ_PLA_END_PROD_COMPR = CE.SEQ_PLA_ENDERECO
   AND CE.SEQ_PLA_CLIENTE        = CL.SEQ_PLA_CLIENTE
   AND CC.SEQ_PLA_PRODUTO        = PD.SEQ_PLA_PRODUTO
   AND CC.SEQ_PLA_UNIDADE        = UN.SEQ_PLA_UNIDADE
   AND CC.SEQ_PLA_MOEDA          = MO.SEQ_PLA_MOEDA
   AND CC.COD_EMPRESA            = EP.COD_EMPRESA
   AND EP.COD_EMPRESA            = FI.COD_EMPRESA
   AND CC.COD_FILIAL             = FI.COD_FILIAL
   AND CC.COD_SAFRA              = SF.COD_SAFRA
