CREATE MATERIALIZED VIEW VW_DADOS_COLHEITA
REFRESH FORCE ON DEMAND
START WITH TO_DATE('05-04-2021 09:44:23', 'DD-MM-YYYY HH24:MI:SS') NEXT SYSDATE + 1/24/60 
AS
SELECT TC.DESC_CULTURA,
       TC.SEQ_PLA_TIPO_CULT,
       CS.COD_SAFRA,
       TS.QTD_HA,
       CS.SC_HA,
       CS.PRECO
  FROM AGRICOLA.BI_CULTURA_SAFRA CS,
       AGRICOLA.TIPO_CULTURA     TC,
       (SELECT SUM(TS1.QTDE_HA) QTD_HA, TS1.COD_SAFRA, TS1.SEQ_PLA_TIPO_CULT
          FROM AGRICOLA.TALHOES_SAFRA TS1
          GROUP BY TS1.COD_SAFRA, TS1.SEQ_PLA_TIPO_CULT)TS
 WHERE CS.SEQ_PLA_TIPO_CULT = TC.SEQ_PLA_TIPO_CULT
   AND CS.COD_SAFRA         = TS.COD_SAFRA
   AND CS.SEQ_PLA_TIPO_CULT = TS.SEQ_PLA_TIPO_CULT
