SELECT DISTINCT GP.NOME_CONTA,
       TO_CHAR(GP.COD_CONTA) COD_CONTA,
       SUM(GC.VALOR_REAL) AS VALOR_REAL,
       'I-RECEITAS' AS TIPO,
       1 ORDEM
  FROM VW_GER_MOVIMENTO_RECEITA    GC,
       AGRICOLA.GER_PLANO_CONTAS GP
 WHERE SUBSTR(GC.COD_CONTA,1,5) = GP.COD_CONTA
   AND GC.COD_TABELA            = GP.COD_TABELA
   AND TO_CHAR(GC.COD_EMPRESA)             LIKE TO_CHAR(DECODE( NVL(:COD_EMPRESA_STRING,'0') ,'0','%', :COD_EMPRESA_STRING )) --PARAM
   AND TO_CHAR(GC.COD_FILIAL)              LIKE TO_CHAR(DECODE( NVL(:COD_FILIAL_STRING ,'0') ,'0','%', :COD_FILIAL_STRING  )) --PARAM
   AND TO_CHAR(GC.COD_SAFRA)               LIKE TO_CHAR(DECODE( NVL(:COD_SAFRA_STRING  ,'0') ,'0','%', :COD_SAFRA_STRING   )) --PARAM
   &CULTURA --AND TRIM(SEQ_PLA_TIPO_CULT) IN ({CULTURA}) --MACRO
   &FAZENDA --AND TRIM(SEQ_PLA_FAZENDA)   IN ({FAZENDA}) --MACRO
 GROUP BY GP.NOME_CONTA, GP.COD_CONTA
UNION
SELECT DISTINCT GP.NOME_CONTA,
       TO_CHAR(GP.COD_CONTA) COD_CONTA,
       SUM(GC.VALOR_REAL) * (-1) AS VALOR_REAL,
       'II-CUSTOS' AS TIPO,
       2 ORDEM
  FROM VW_GER_MOVIMENTO_CUSTOS     GC,
       AGRICOLA.GER_PLANO_CONTAS GP
 WHERE SUBSTR(GC.COD_CONTA,1,5) = GP.COD_CONTA
   AND GC.COD_TABELA            = GP.COD_TABELA
   AND TO_CHAR(GC.COD_EMPRESA)             LIKE TO_CHAR(DECODE( NVL(:COD_EMPRESA_STRING,'0') ,'0','%', :COD_EMPRESA_STRING )) --PARAM
   AND TO_CHAR(GC.COD_FILIAL)              LIKE TO_CHAR(DECODE( NVL(:COD_FILIAL_STRING ,'0') ,'0','%', :COD_FILIAL_STRING  )) --PARAM
   AND TO_CHAR(GC.COD_SAFRA)               LIKE TO_CHAR(DECODE( NVL(:COD_SAFRA_STRING  ,'0') ,'0','%', :COD_SAFRA_STRING   )) --PARAM
   &CULTURA --AND TRIM(SEQ_PLA_TIPO_CULT) IN ({CULTURA}) --MACRO
   &FAZENDA --AND TRIM(SEQ_PLA_FAZENDA)   IN ({FAZENDA}) --MACRO   
 GROUP BY GP.NOME_CONTA, GP.COD_CONTA
/*
UNION
SELECT DISTINCT TO_CHAR(' ') NOME_CONTA,
       TO_CHAR(' ') COD_CONTA,
       (GR.VALOR_REAL) - (GC.VALOR_REAL) AS VALOR_REAL,
       'III- RESULTADO' AS TIPO,
       3 ORDEM
  FROM (SELECT SUM(GR.VALOR_REAL) VALOR_REAL FROM VW_GER_MOVIMENTO_RECEITA GR) GR,
       (SELECT SUM(GC.VALOR_REAL) VALOR_REAL FROM VW_GER_MOVIMENTO_CUSTOS  GC) GC
*/
 ORDER BY 4,3       
