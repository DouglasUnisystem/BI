CREATE MATERIALIZED VIEW VW_CONS_RETROSP_PR REFRESH FORCE ON DEMAND START WITH TO_DATE('10-02-2021 11:44:56', 'DD-MM-YYYY HH24:MI:SS') NEXT SYSDATE + 10/24/60 AS
SELECT GM.COD_TABELA,TRIM(SUBSTR(GM.Cod_Conta,1,5)) AS COD_CONTA, TRUNC(GM.Data_Mvto) Data_Mvto, GM.Cod_Empresa, GM.Cod_Safra,
                       GM.COD_GRUPO_CONTA,
                       Sum(DECODE(TO_CHAR(GM.Data_Mvto,'MM'),'01'  ,DECODE(GM.Seq_Pla_Pagar  ,NULL,DECODE(GM.Seq_Pla_Mov_Fin,NULL,DECODE(GM.FORM_LANCAMENTO,'DFMSAIDAFT',DECODE(PC.DEBITO_CREDITO,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'','')),AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),DECODE(FH.Deb_Cred,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''))),-AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),0)) as Total_Jan,
                       Sum(DECODE(TO_CHAR(GM.Data_Mvto,'MM'),'02'  ,DECODE(GM.Seq_Pla_Pagar  ,NULL,DECODE(GM.Seq_Pla_Mov_Fin,NULL,DECODE(GM.FORM_LANCAMENTO,'DFMSAIDAFT',DECODE(PC.DEBITO_CREDITO,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'','')),AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),DECODE(FH.Deb_Cred,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''))),-AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),0)) as Total_Fev,
                       Sum(DECODE(TO_CHAR(GM.Data_Mvto,'MM'),'03'  ,DECODE(GM.Seq_Pla_Pagar  ,NULL,DECODE(GM.Seq_Pla_Mov_Fin,NULL,DECODE(GM.FORM_LANCAMENTO,'DFMSAIDAFT',DECODE(PC.DEBITO_CREDITO,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'','')),AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),DECODE(FH.Deb_Cred,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''))),-AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),0)) as Total_Mar,
                       Sum(DECODE(TO_CHAR(GM.Data_Mvto,'MM'),'04'  ,DECODE(GM.Seq_Pla_Pagar  ,NULL,DECODE(GM.Seq_Pla_Mov_Fin,NULL,DECODE(GM.FORM_LANCAMENTO,'DFMSAIDAFT',DECODE(PC.DEBITO_CREDITO,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'','')),AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),DECODE(FH.Deb_Cred,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''))),-AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),0)) as Total_Abr,
                       Sum(DECODE(TO_CHAR(GM.Data_Mvto,'MM'),'05'  ,DECODE(GM.Seq_Pla_Pagar  ,NULL,DECODE(GM.Seq_Pla_Mov_Fin,NULL,DECODE(GM.FORM_LANCAMENTO,'DFMSAIDAFT',DECODE(PC.DEBITO_CREDITO,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'','')),AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),DECODE(FH.Deb_Cred,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''))),-AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),0)) as Total_Mai,
                       Sum(DECODE(TO_CHAR(GM.Data_Mvto,'MM'),'06'  ,DECODE(GM.Seq_Pla_Pagar  ,NULL,DECODE(GM.Seq_Pla_Mov_Fin,NULL,DECODE(GM.FORM_LANCAMENTO,'DFMSAIDAFT',DECODE(PC.DEBITO_CREDITO,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'','')),AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),DECODE(FH.Deb_Cred,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''))),-AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),0)) as Total_Jun,
                       Sum(DECODE(TO_CHAR(GM.Data_Mvto,'MM'),'07'  ,DECODE(GM.Seq_Pla_Pagar  ,NULL,DECODE(GM.Seq_Pla_Mov_Fin,NULL,DECODE(GM.FORM_LANCAMENTO,'DFMSAIDAFT',DECODE(PC.DEBITO_CREDITO,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'','')),AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),DECODE(FH.Deb_Cred,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''))),-AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),0)) as Total_Jul,
                       Sum(DECODE(TO_CHAR(GM.Data_Mvto,'MM'),'08'  ,DECODE(GM.Seq_Pla_Pagar  ,NULL,DECODE(GM.Seq_Pla_Mov_Fin,NULL,DECODE(GM.FORM_LANCAMENTO,'DFMSAIDAFT',DECODE(PC.DEBITO_CREDITO,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'','')),AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),DECODE(FH.Deb_Cred,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''))),-AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),0)) as Total_Ago,
                       Sum(DECODE(TO_CHAR(GM.Data_Mvto,'MM'),'09'  ,DECODE(GM.Seq_Pla_Pagar  ,NULL,DECODE(GM.Seq_Pla_Mov_Fin,NULL,DECODE(GM.FORM_LANCAMENTO,'DFMSAIDAFT',DECODE(PC.DEBITO_CREDITO,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'','')),AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),DECODE(FH.Deb_Cred,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''))),-AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),0)) as Total_Set,
                       Sum(DECODE(TO_CHAR(GM.Data_Mvto,'MM'),'10'  ,DECODE(GM.Seq_Pla_Pagar  ,NULL,DECODE(GM.Seq_Pla_Mov_Fin,NULL,DECODE(GM.FORM_LANCAMENTO,'DFMSAIDAFT',DECODE(PC.DEBITO_CREDITO,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'','')),AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),DECODE(FH.Deb_Cred,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''))),-AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),0)) as Total_Out,
                       Sum(DECODE(TO_CHAR(GM.Data_Mvto,'MM'),'11'  ,DECODE(GM.Seq_Pla_Pagar  ,NULL,DECODE(GM.Seq_Pla_Mov_Fin,NULL,DECODE(GM.FORM_LANCAMENTO,'DFMSAIDAFT',DECODE(PC.DEBITO_CREDITO,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'','')),AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),DECODE(FH.Deb_Cred,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''))),-AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),0)) as Total_Nov,
                       Sum(DECODE(TO_CHAR(GM.Data_Mvto,'MM'),'12'  ,DECODE(GM.Seq_Pla_Pagar  ,NULL,DECODE(GM.Seq_Pla_Mov_Fin,NULL,DECODE(GM.FORM_LANCAMENTO,'DFMSAIDAFT',DECODE(PC.DEBITO_CREDITO,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'','')),AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),DECODE(FH.Deb_Cred,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''))),-AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),0)) as Total_Dez,
                       Sum(DECODE(TO_CHAR(GM.Data_Mvto,'MM'),'00',0,DECODE(GM.Seq_Pla_Pagar  ,NULL,DECODE(GM.Seq_Pla_Mov_Fin,NULL,DECODE(GM.FORM_LANCAMENTO,'DFMSAIDAFT',DECODE(PC.DEBITO_CREDITO,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'','')),AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),DECODE(FH.Deb_Cred,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''))),-AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')  ))) as Total_Ano
                  From AGRICOLA.Ger_Movimento    GM,
                       AGRICOLA.Fin_Movimento    FM,
                       AGRICOLA.Fin_Historicos   FH,
                       AGRICOLA.Fazendas         FZ,
                       AGRICOLA.Ger_Plano_Contas PC,
                       AGRICOLA.PAR_GERAL        PG
                 Where GM.Cod_Tabela = PC.Cod_Tabela
                   And GM.Cod_Conta  = PC.Cod_Conta
                   And GM.Seq_Pla_Fazenda = FZ.Seq_Pla_Fazenda(+)
                   And GM.Seq_Pla_Mov_Fin  = FM.Seq_Pla_Mov_Fin(+)
                   And FM.Seq_Pla_Fin_Hist = FH.Seq_Pla_Fin_Hist(+)
                   AND DECODE(GM.FORM_LANCAMENTO,NULL,'XXXX',UPPER(GM.FORM_LANCAMENTO)) <> UPPER('dfmBaixaReceber')
                   And DECODE(GM.FORM_LANCAMENTO,NULL,'XXXX',UPPER(GM.FORM_LANCAMENTO)) <> UPPER('dfmBaixaPagar5')
                   And DECODE(GM.FORM_LANCAMENTO,NULL,'XXXX',UPPER(GM.FORM_LANCAMENTO)) <> UPPER('dfmBaixaPagar1')
                   AND DECODE(GM.FORM_LANCAMENTO,NULL,'XXXX',UPPER(GM.FORM_LANCAMENTO)) <> UPPER('dfmBaixaAutPagar')
                   AND DECODE(GM.FORM_LANCAMENTO,NULL,'XXXX',UPPER(GM.FORM_LANCAMENTO)) <> UPPER('dfmBaixaAutReceber')
                   And DECODE(FM.CANCELADO,NULL,'N',FM.CANCELADO)='N'
                 GROUP BY GM.COD_TABELA,SUBSTR(GM.Cod_Conta,1,5),GM.COD_GRUPO_CONTA, TRUNC(GM.Data_Mvto), GM.Cod_Empresa, GM.Cod_Safra
                UNION
                SELECT GM.COD_TABELA,TRIM(SUBSTR(GM.Cod_Conta,1,8)) AS COD_CONTA, TRUNC(GM.Data_Mvto) Data_Mvto, GM.Cod_Empresa, GM.Cod_Safra,
                       GM.COD_GRUPO_CONTA,
                       Sum(DECODE(TO_CHAR(GM.Data_Mvto,'MM'),'01'  ,DECODE(GM.Seq_Pla_Pagar  ,NULL,DECODE(GM.Seq_Pla_Mov_Fin,NULL,DECODE(GM.FORM_LANCAMENTO,'DFMSAIDAFT',DECODE(PC.DEBITO_CREDITO,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'','')),AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),DECODE(FH.Deb_Cred,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''))),-AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),0)) as Total_Jan,
                       Sum(DECODE(TO_CHAR(GM.Data_Mvto,'MM'),'02'  ,DECODE(GM.Seq_Pla_Pagar  ,NULL,DECODE(GM.Seq_Pla_Mov_Fin,NULL,DECODE(GM.FORM_LANCAMENTO,'DFMSAIDAFT',DECODE(PC.DEBITO_CREDITO,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'','')),AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),DECODE(FH.Deb_Cred,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''))),-AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),0)) as Total_Fev,
                       Sum(DECODE(TO_CHAR(GM.Data_Mvto,'MM'),'03'  ,DECODE(GM.Seq_Pla_Pagar  ,NULL,DECODE(GM.Seq_Pla_Mov_Fin,NULL,DECODE(GM.FORM_LANCAMENTO,'DFMSAIDAFT',DECODE(PC.DEBITO_CREDITO,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'','')),AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),DECODE(FH.Deb_Cred,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''))),-AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),0)) as Total_Mar,
                       Sum(DECODE(TO_CHAR(GM.Data_Mvto,'MM'),'04'  ,DECODE(GM.Seq_Pla_Pagar  ,NULL,DECODE(GM.Seq_Pla_Mov_Fin,NULL,DECODE(GM.FORM_LANCAMENTO,'DFMSAIDAFT',DECODE(PC.DEBITO_CREDITO,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'','')),AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),DECODE(FH.Deb_Cred,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''))),-AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),0)) as Total_Abr,
                       Sum(DECODE(TO_CHAR(GM.Data_Mvto,'MM'),'05'  ,DECODE(GM.Seq_Pla_Pagar  ,NULL,DECODE(GM.Seq_Pla_Mov_Fin,NULL,DECODE(GM.FORM_LANCAMENTO,'DFMSAIDAFT',DECODE(PC.DEBITO_CREDITO,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'','')),AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),DECODE(FH.Deb_Cred,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''))),-AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),0)) as Total_Mai,
                       Sum(DECODE(TO_CHAR(GM.Data_Mvto,'MM'),'06'  ,DECODE(GM.Seq_Pla_Pagar  ,NULL,DECODE(GM.Seq_Pla_Mov_Fin,NULL,DECODE(GM.FORM_LANCAMENTO,'DFMSAIDAFT',DECODE(PC.DEBITO_CREDITO,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'','')),AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),DECODE(FH.Deb_Cred,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''))),-AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),0)) as Total_Jun,
                       Sum(DECODE(TO_CHAR(GM.Data_Mvto,'MM'),'07'  ,DECODE(GM.Seq_Pla_Pagar  ,NULL,DECODE(GM.Seq_Pla_Mov_Fin,NULL,DECODE(GM.FORM_LANCAMENTO,'DFMSAIDAFT',DECODE(PC.DEBITO_CREDITO,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'','')),AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),DECODE(FH.Deb_Cred,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''))),-AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),0)) as Total_Jul,
                       Sum(DECODE(TO_CHAR(GM.Data_Mvto,'MM'),'08'  ,DECODE(GM.Seq_Pla_Pagar  ,NULL,DECODE(GM.Seq_Pla_Mov_Fin,NULL,DECODE(GM.FORM_LANCAMENTO,'DFMSAIDAFT',DECODE(PC.DEBITO_CREDITO,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'','')),AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),DECODE(FH.Deb_Cred,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''))),-AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),0)) as Total_Ago,
                       Sum(DECODE(TO_CHAR(GM.Data_Mvto,'MM'),'09'  ,DECODE(GM.Seq_Pla_Pagar  ,NULL,DECODE(GM.Seq_Pla_Mov_Fin,NULL,DECODE(GM.FORM_LANCAMENTO,'DFMSAIDAFT',DECODE(PC.DEBITO_CREDITO,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'','')),AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),DECODE(FH.Deb_Cred,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''))),-AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),0)) as Total_Set,
                       Sum(DECODE(TO_CHAR(GM.Data_Mvto,'MM'),'10'  ,DECODE(GM.Seq_Pla_Pagar  ,NULL,DECODE(GM.Seq_Pla_Mov_Fin,NULL,DECODE(GM.FORM_LANCAMENTO,'DFMSAIDAFT',DECODE(PC.DEBITO_CREDITO,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'','')),AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),DECODE(FH.Deb_Cred,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''))),-AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),0)) as Total_Out,
                       Sum(DECODE(TO_CHAR(GM.Data_Mvto,'MM'),'11'  ,DECODE(GM.Seq_Pla_Pagar  ,NULL,DECODE(GM.Seq_Pla_Mov_Fin,NULL,DECODE(GM.FORM_LANCAMENTO,'DFMSAIDAFT',DECODE(PC.DEBITO_CREDITO,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'','')),AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),DECODE(FH.Deb_Cred,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''))),-AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),0)) as Total_Nov,
                       Sum(DECODE(TO_CHAR(GM.Data_Mvto,'MM'),'12'  ,DECODE(GM.Seq_Pla_Pagar  ,NULL,DECODE(GM.Seq_Pla_Mov_Fin,NULL,DECODE(GM.FORM_LANCAMENTO,'DFMSAIDAFT',DECODE(PC.DEBITO_CREDITO,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'','')),AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),DECODE(FH.Deb_Cred,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''))),-AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),0)) as Total_Dez,
                       Sum(DECODE(TO_CHAR(GM.Data_Mvto,'MM'),'00',0,DECODE(GM.Seq_Pla_Pagar  ,NULL,DECODE(GM.Seq_Pla_Mov_Fin,NULL,DECODE(GM.FORM_LANCAMENTO,'DFMSAIDAFT',DECODE(PC.DEBITO_CREDITO,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'','')),AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')),DECODE(FH.Deb_Cred,'D',-AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''),AGRICOLA.ConverteValor(GM.VALOR_REAL,'     75601',GM.DATA_MVTO,'',''))),-AGRICOLA.ConverteValor(DECODE(GM.SEQ_PLA_MOEDA, PG.MOEDA_DOLAR,GM.VALOR_DOLAR, GM.VALOR_REAL),'     75601',GM.DATA_MVTO,'','')  ))) as Total_Ano
                  From AGRICOLA.Ger_Movimento    GM,
                       AGRICOLA.Fin_Movimento    FM,
                       AGRICOLA.Fin_Historicos   FH,
                       AGRICOLA.Fazendas         FZ,
                       AGRICOLA.Ger_Plano_Contas PC,
                       AGRICOLA.PAR_GERAL        PG
                 Where GM.Cod_Tabela = PC.Cod_Tabela
                   And GM.Cod_Conta  = PC.Cod_Conta
                   And GM.Seq_Pla_Fazenda = FZ.Seq_Pla_Fazenda(+)
                   And GM.Seq_Pla_Mov_Fin  = FM.Seq_Pla_Mov_Fin(+)
                   And FM.Seq_Pla_Fin_Hist = FH.Seq_Pla_Fin_Hist(+)
                   AND DECODE(GM.FORM_LANCAMENTO,NULL,'XXXX',UPPER(GM.FORM_LANCAMENTO)) <> UPPER('dfmBaixaReceber')
                   And DECODE(GM.FORM_LANCAMENTO,NULL,'XXXX',UPPER(GM.FORM_LANCAMENTO)) <> UPPER('dfmBaixaPagar5')
                   And DECODE(GM.FORM_LANCAMENTO,NULL,'XXXX',UPPER(GM.FORM_LANCAMENTO)) <> UPPER('dfmBaixaPagar1')
                   AND DECODE(GM.FORM_LANCAMENTO,NULL,'XXXX',UPPER(GM.FORM_LANCAMENTO)) <> UPPER('dfmBaixaAutPagar')
                   AND DECODE(GM.FORM_LANCAMENTO,NULL,'XXXX',UPPER(GM.FORM_LANCAMENTO)) <> UPPER('dfmBaixaAutReceber')
                   And DECODE(FM.CANCELADO,NULL,'N',FM.CANCELADO)='N'
                 GROUP BY GM.COD_TABELA,SUBSTR(GM.Cod_Conta,1,8), GM.COD_GRUPO_CONTA, TRUNC(GM.Data_Mvto), GM.Cod_Empresa, GM.Cod_Safra;
